#!/usr/bin/env bash
# .sh/bin/setup-clone 20220202 - 20220202
# Copyright (C) 1995-2022 Mark Constable <markc@renta.net> (AGPL-3.0)

[[ $1 =~ '-h' ]] && echo "Usage: setup-clone" && exit 1

[[ $(id -u) -gt 0 ]] && echo "ERROR: must be root (use sudo -i)" && exit 2

echo -n '' > /etc/machine-id
rm /etc/hostname

cp ~/.sh/etc/_etc_systemd_system_regenerate-ssh-host-keys.service /etc/systemd/system/regenerate-ssh-host-keys.service
systemctl daemon-reload
systemctl enable regenerate-ssh-host-keys

echo "You can now convert this VM/CT into a template"
